openapi: '3.0.0'
info:
  version: 1.0.0
  title: Swagger Petstore
  license:
    name: MIT
servers:
  - url: http://petstore.swagger.io/v1
paths:
  /top-level-all-of:
    post:
      operationId: TopLevelAllOf
      responses:
        201:
          description: test
          content:
            application/hal+json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyType'
                  - $ref: '#/components/schemas/Override'
                  - type: object
                    properties:
                      nestedTopLevelAllOf:
                        allOf:
                          - $ref: '#/components/schemas/MyType'
                          - $ref: '#/components/schemas/Override'
                      nestedTopLevelAllOfTwo:
                        type: object
                        properties:
                          test:
                            allOf:
                              - $ref: '#/components/schemas/MyType'
                              - $ref: '#/components/schemas/Override'
  /nested-all-of:
    post:
      operationId: NestedAllOf
      responses:
        201:
          description: test
          content:
            application/hal+json:
              schema:
                type: object
                properties:
                  test:
                    allOf:
                      - $ref: '#/components/schemas/MyType'
                      - $ref: '#/components/schemas/Override'
                  testReverse:
                    allOf:
                      - $ref: '#/components/schemas/Override'
                      - $ref: '#/components/schemas/MyType'
  /array-top-level-all-of:
    post:
      operationId: ArrayTopLevelAllOf
      responses:
        201:
          description: test
          content:
            application/hal+json:
              schema:
                type: array
                items:
                  allOf:
                    - $ref: '#/components/schemas/MyType'
                    - description: 'final description'
  /array-nested-all-of:
    post:
      operationId: ArrayNestedAllOf
      responses:
        201:
          description: test
          content:
            application/hal+json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    test:
                      allOf:
                        - $ref: '#/components/schemas/MyType'
                        - description: 'final description'
components:
  schemas:
    MyAnotherType:
      type: object
      properties:
        children:
          properties:
            date:
              type: string
    MyType:
      description: my type description
      required:
        - date
      allOf:
        - $ref: '#/components/schemas/MyAnotherType'
        - type: object
          properties:
            date:
              type: string
    Override:
      type: object
      description: override description
      properties:
        date:
          type: string
          deprecated: true
        children:
          required:
            - 'date'
          properties:
            date:
              type: string
              description: 'override description'
              deprecated: true
